<!DOCTYPE html>
<html>
<head>
    <title>Admin - Transaction Manager</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { background: #111; color: white; font-family: sans-serif; padding: 20px; }
        .card { background: #222; padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 5px solid #555; display: flex; justify-content: space-between; align-items: center; }
        .type-DEPOSIT { border-color: #2ea043; } 
        .type-WITHDRAW { border-color: #e74c3c; }
        button { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-left: 5px; }
        .btn-yes { background: #2ea043; color: white; } .btn-no { background: #e74c3c; color: white; }
    </style>
</head>
<body>
    <h2>ðŸ’° Pending Transactions (Deposit & Withdraw)</h2>
    <div id="list">Loading...</div>

    <script>
        const socket = io();
        setInterval(() => socket.emit('admin-get-pending'), 2000);

        socket.on('admin-pending-list', list => {
            const d = document.getElementById('list'); 
            if(list.length===0) { d.innerHTML="<p>No requests.</p>"; return; }
            d.innerHTML = "";
            list.forEach(t => {
                let color = t.type === 'DEPOSIT' ? '#2ea043' : '#e74c3c';
                let div = document.createElement('div');
                div.className = `card type-${t.type}`;
                div.innerHTML = `
                    <div>
                        <strong style="color:${color}">${t.type}</strong> | 
                        User: <strong>${t.username}</strong> | 
                        Amt: <strong>â‚¹${t.amount}</strong><br>
                        <small>Detail: ${t.details}</small>
                    </div>
                    <div>
                        <button class="btn-yes" onclick="act('${t._id}','APPROVE')">âœ” Approve</button>
                        <button class="btn-no" onclick="act('${t._id}','REJECT')">âœ– Reject</button>
                    </div>
                `;
                d.appendChild(div);
            });
        });

        function act(id, action) {
            if(confirm(`Are you sure you want to ${action}?`)) {
                socket.emit('admin-action', { id, action });
            }
        }
    </script>
</body>
</html>